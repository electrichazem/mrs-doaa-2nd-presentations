<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Presentations | Hero Presentations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-light: #eef2ff;
            --secondary-color: #3f37c9;
            --accent-color: #4cc9f0;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gray-color: #6c757d;
            --light-gray: #e9ecef;
            --border-radius: 12px;
            --box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2.5rem 0;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 0;
            font-weight: 400;
        }

        .presentations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .presentation-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid var(--light-gray);
        }

        .presentation-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        /* Preview Toggle Styles */
        .preview-toggle {
            display: flex;
            justify-content: center;
            background-color: var(--light-color);
            border-bottom: 1px solid var(--light-gray);
        }

        .preview-toggle button {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray-color);
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preview-toggle button:hover {
            color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .preview-toggle button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background-color: var(--primary-light);
        }

        /* Video and PPTX Preview Styles */
        .video-preview {
            position: relative;
            padding-top: 56.25%;
            background-color: #000;
        }

        .video-preview iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .pptx-preview {
            position: relative;
            padding-top: 56.25%;
            background-color: #f1f3f5;
            border-bottom: 1px solid var(--light-gray);
        }

        .pptx-preview iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .no-preview {
            padding: 2rem;
            text-align: center;
            color: var(--gray-color);
            background-color: var(--light-color);
            font-size: 0.95rem;
        }

        .hidden {
            display: none;
        }

        /* Card Content Styles */
        .card-content {
            padding: 1.5rem;
        }

        .student-info {
            margin-bottom: 1rem;
        }

        .student-name {
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .presentation-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--gray-color);
            margin: 1.25rem 0;
            padding: 0.75rem 0;
            border-top: 1px solid var(--light-gray);
            border-bottom: 1px solid var(--light-gray);
        }

        .presentation-duration {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Action Buttons */
        .presentation-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-size: 0.95rem;
            border: none;
            flex: 1;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.2);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.1);
        }

        /* Footer Styles */
        footer {
            background-color: var(--dark-color);
            color: white;
            text-align: center;
            padding: 2.5rem 0;
            margin-top: 4rem;
        }

        footer p {
            opacity: 0.8;
            font-size: 0.95rem;
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .presentations-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            h1 {
                font-size: 2rem;
            }

            .preview-toggle button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .presentation-actions {
                flex-direction: column;
                gap: 0.75rem;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1>Student Presentations</h1>
            <div class="subtitle">Hero Presentations • Mrs. Doaa • Grade 10/Semester 2</div>
        </div>
    </header>

    <main class="container">
        <div class="presentations-grid" id="presentationsContainer">
            <!-- Presentations will be inserted here by JavaScript -->
        </div>
    </main>

    <footer>
        <div class="container">
            <p>© 2024 Hero Presentations. All rights reserved.</p>
        </div>
    </footer>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            const presentationsContainer = document.getElementById('presentationsContainer');

            function loadPptx(url, id) {
                const container = document.getElementById(`pptx-preview-${id}`);
                container.innerHTML = `
        <iframe src="${url}" frameborder="0" allowfullscreen style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;"></iframe>
    `;
            }


            const data = {
                "presentations": [
                    {
                        "id": 1,
                        "student": {
                            "name": "Ibram Hany"
                        },
                        "videoId": "b75d2f8a-1e73-46e7-b159-24ec55d42654",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%A7%D8%A8%D8%B1%D8%A7%D9%85%20%D9%87%D8%A7%D9%86%D9%8A.pptx",
                        "duration": "12:45"
                    },
                    {
                        "id": 2,
                        "student": {
                            "name": "Ahmed Amr"
                        },
                        "videoId": "d8d329d4-da67-4d50-8d1a-be36313f7e8d",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%A7%D8%AD%D9%85%D8%AF%20%D8%B9%D9%85%D8%B1%D9%88.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 3,
                        "student": {
                            "name": "Ahmed Hamed"
                        },
                        "videoId": "048f99b8-0790-4c1c-8342-b3588fc06527",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%A7%D8%AD%D9%85%D8%AF%20%D8%AD%D8%A7%D9%85%D8%AF.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 4,
                        "student": {
                            "name": "Adham Ayman"
                        },
                        "videoId": "5ff0a18a-ed51-4871-9b26-9144c1d99238",
                        "slidesUrl": "",
                        "duration": "15:30"
                    },
                    {
                        "id": 5,
                        "student": {
                            "name": "Akmal Hossam"
                        },
                        "videoId": "",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%A7%D9%83%D9%85%D9%84.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 6,
                        "student": {
                            "name": "Moatsem"
                        },
                        "videoId": "",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%A7%D9%84%D9%85%D8%B9%D8%AA%D8%B5%D9%85.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 7,
                        "student": {
                            "name": "Hazem Emad"
                        },
                        "videoId": "971db68a-2804-45cb-be51-8eb712fa358e",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%AD%D8%A7%D8%B2%D9%85%20%D8%B9%D9%85%D8%A7%D8%AF.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 8,
                        "student": {
                            "name": "Abd-Elrahaman"
                        },
                        "videoId": "0e7ecee3-2b4c-4b39-92b7-67e126a48eca",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D8%B1%D8%AD%D9%85%D9%86.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 9,
                        "student": {
                            "name": "Abd-Allah"
                        },
                        "videoId": "7f38e6bd-0543-4a0b-913b-0837bd56649c",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%B9%D8%A8%D8%AF%D8%A7%D9%84%D9%84%D9%87.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 10,
                        "student": {
                            "name": "Omar Saber"
                        },
                        "videoId": "25ac5f57-24a7-436c-9777-8b193f6d087e",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/Omar%20Elwany.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 11,
                        "student": {
                            "name": "Omar Mohamed"
                        },
                        "videoId": "940a48c6-e899-4493-842a-deadc2c44c3f",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/omar-mohamed.pdf",
                        "duration": "15:30"
                    },
                    {
                        "id": 12,
                        "student": {
                            "name": "Amr"
                        },
                        "videoId": "7e2233d6-88e7-4dcb-92e1-d7995faf2ff3",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/amr.pptx",
                        "duration": "15:30"
                    },

                    {
                        "id": 13,
                        "student": {
                            "name": "Kevin Martin"
                        },
                        "videoId": "23a6d026-30d8-44d5-9fe8-1fc1c2e2dca7",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D9%83%D9%8A%D9%81%D9%86.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 14,
                        "student": {
                            "name": "Mohamed Ibrahim Tayel"
                        },
                        "videoId": "8e1605af-6941-4d06-ac02-7df871146041",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D8%B7%D8%A7%D9%8A%D9%84.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 15,
                        "student": {
                            "name": "Mohaemed Hassan"
                        },
                        "videoId": "47385b99-6449-40a3-8c67-1e780343e3b0",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/Mohamed%20Hassan%20Presentation.pdf",
                        "duration": "15:30"
                    },
                    {
                        "id": 16,
                        "student": {
                            "name": "Mostafa El-Arabi"
                        },
                        "videoId": "36ab2494-7cd9-430c-84b2-7c5d70953d98",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/mostafa.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 17,
                        "student": {
                            "name": "Moatz Ahmed"
                        },
                        "videoId": "182cd385-1a46-4128-8f79-2d10310b7b5a",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D9%85%D8%B9%D8%AA%D8%B2.pdf",
                        "duration": "15:30"
                    },
                    {
                        "id": 18,
                        "student": {
                            "name": "Youssef Ahmed"
                        },
                        "videoId": "2f9ec249-983b-49c9-a22a-14dabaa1c99c",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D9%8A%D9%88%D8%B3%D9%81%20%D8%A3%D8%AD%D9%85%D8%AF.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 19,
                        "student": {
                            "name": "Youssef Alaa"
                        },
                        "videoId": "5d60686c-a208-425d-b86a-2b018cfc8bb0",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/%D9%8A%D9%88%D8%B3%D9%81%20%D8%B9%D9%84%D8%A7%D8%A1.pptx",
                        "duration": "15:30"
                    },
                    {
                        "id": 20,
                        "student": {
                            "name": "Youssef Mohamed"
                        },
                        "videoId": "",
                        "slidesUrl": "",
                        "duration": "15:30"
                    },
                    {
                        "id": 21,
                        "student": {
                            "name": "Youssef Hany"
                        },
                        "videoId": "d8145126-ceed-4b11-82b4-f9fe9f44ae2f",
                        "slidesUrl": "https://cdn.expertfle.org/mrs-doaa-presentation-files/Youssef%20Hany.pptx",
                        "duration": "15:30"
                    },

                ]
            };

            function createVideoIframe(videoId) {
                if (!videoId) {
                    return '<div class="no-preview"><i class="fas fa-video-slash"></i> No video available</div>';
                }
                return `
                <div class="video-preview">
                    <iframe 
                        src="https://iframe.mediadelivery.net/embed/385613/${videoId}?autoplay=false&loop=false&muted=false&preload=true&responsive=true" 
                        loading="lazy" 
                        allow="accelerometer;gyroscope;autoplay;encrypted-media;picture-in-picture;" 
                        allowfullscreen>
                    </iframe>
                </div>
            `;
            }

            function createPptxPreview(slidesUrl, hasVideo, id) {
                if (!slidesUrl) {
                    return '<div class="no-preview"><i class="far fa-file-powerpoint"></i> No slides available</div>';
                }

                if (!hasVideo) {
                    return `
            <div class="pptx-preview" id="pptx-preview-${id}">
                <button class="btn btn-outline" onclick="loadPptx('${slidesUrl}', '${id}')">
                    <i class="fas fa-file-powerpoint"></i> Show Slides
                </button>
            </div>
        `;
                }

                return `
        <div class="pptx-preview">
            <iframe src="https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(slidesUrl)}" frameborder="0" allowfullscreen></iframe>
        </div>
    `;
            }

            function loadPptx(url, id) {
                const container = document.getElementById(`pptx-preview-${id}`);
                container.innerHTML = `
        <iframe src="https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(url)}" frameborder="0" allowfullscreen style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;"></iframe>
    `;
            }
            function togglePreview(button, id, type) {
                const buttons = button.parentElement.querySelectorAll('button');
                buttons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.style.fontWeight = '600';
                });
                button.classList.add('active');
                button.style.fontWeight = '700';

                document.getElementById(`video-${id}`).classList.toggle('hidden', type !== 'video');
                document.getElementById(`slides-${id}`).classList.toggle('hidden', type !== 'slides');
            }

            function renderPresentations(presentations) {
                presentationsContainer.innerHTML = presentations.map(presentation => {
                    const hasVideo = !!presentation.videoId;
                    const hasSlides = !!presentation.slidesUrl;

                    // Only show toggle buttons if both video and slides exist
                    const showToggleButtons = hasVideo && hasSlides;

                    // Default to showing slides if no video exists
                    const defaultShowVideo = hasVideo;
                    const defaultShowSlides = !hasVideo && hasSlides;

                    return `
                    <div class="presentation-card">
                        ${showToggleButtons ? `
                        <div class="preview-toggle">
                            <button class="${defaultShowVideo ? 'active' : ''}" onclick="togglePreview(this, ${presentation.id}, 'video')" style="font-weight: ${defaultShowVideo ? '700' : '600'};">
                                <i class="fas fa-video"></i> Video
                            </button>
                            <button class="${defaultShowSlides ? 'active' : ''}" onclick="togglePreview(this, ${presentation.id}, 'slides')" style="font-weight: ${defaultShowSlides ? '700' : '600'};">
                                <i class="fas fa-file-powerpoint"></i> Slides
                            </button>
                        </div>
                        ` : ''}
                        
                        <div id="video-${presentation.id}" class="${defaultShowVideo ? '' : 'hidden'}">
                            ${createVideoIframe(presentation.videoId)}
                        </div>
                        
                        <div id="slides-${presentation.id}" class="${defaultShowSlides ? '' : 'hidden'}">
                            ${createPptxPreview(presentation.slidesUrl, hasVideo, presentation.id)}
                        </div>
                        
                        <div class="card-content">
                            <div class="student-info">
                                <div class="student-name">${presentation.student.name}</div>
                            </div>
    
                            
                            <div class="presentation-actions">
                                ${hasVideo ? `
                                <a href="https://iframe.mediadelivery.net/play/385613/${presentation.videoId}" 
                                   target="_blank" 
                                   class="btn btn-primary">
                                    <i class="fas fa-play"></i> Watch Fullscreen
                                </a>
                                ` : ''}
                                
                                ${hasSlides ? `
                                <a href="${presentation.slidesUrl}" 
                                   target="_blank" 
                                   class="btn ${hasVideo ? 'btn-outline' : 'btn-primary'}">
                                    <i class="fas fa-download"></i> Download Slides
                                </a>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                }).join('');
            }

            renderPresentations(data.presentations);

            window.togglePreview = togglePreview;
        });
    </script>
</body>

</html>